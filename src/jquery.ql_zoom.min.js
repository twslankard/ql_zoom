(function(b){b.fn.imagesLoaded=function(k){var c=this.filter("img"),r=c.length;c.one("load",function(){--r<=0&&k.call(c,this)}).each(function(){if(this.complete||this.complete===undefined){var i=this.src;this.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";this.src=i}});return this}})(jQuery);
(function(b,k){var c=b.jQuery||b.Cowboy||(b.Cowboy={}),r;c.throttle=r=function(i,g,e,l){function f(){function h(){n=+new Date;e.apply(o,m)}function p(){d=k}var o=this,j=+new Date-n,m=arguments;l&&!d&&h();d&&clearTimeout(d);if(l===k&&j>i)h();else if(g!==true)d=setTimeout(l?p:h,l===k?i-j:i)}var d,n=0;if(typeof g!=="boolean"){l=e;e=g;g=k}if(c.guid)f.guid=e.guid=e.guid||c.guid++;return f};c.debounce=function(i,g,e){return e===k?r(i,g,false):r(i,e,g!==false)}})(this);
(function(b){b.fn.ql_zoom=function(k){var c=b.extend({},b.fn.ql_zoom.defaultOptions,k);return this.each(function(){function r(a){var q;a=[a.pageX-e.left-~~(s/2),a.pageY-e.top-~~(t/2)];d.css({left:a[0]+"px",top:a[1]+"px"});q=d.position();a=q.left;q=q.top;var u,v,w,x,y,z,A,B;u=a*p/j+s/(p/j)/2;v=q*o/m+s/(o/m)/2;w=s;x=t;z=y=0;A=s;B=t;if(u>p-s)w=A=j-a;if(v>o-t)B=x=m-q;if(u<0){y=Math.abs(a)+a/(p/j);u=0}if(v<0){z=Math.abs(q)+q/(o/m);v=0}a=[~~u,~~v,~~w,~~x,~~y,~~z,~~A,~~B];try{g.clearRect(0,0,400,400);g.drawImage(n[0],
a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7])}catch(C){console.dir(C)}}function i(){if(o<=m+m/10){d.remove();n.remove()}else if(p<=j+j/10){d.remove();n.remove()}else{f.mouseenter(function(){d.fadeIn(c.speed)}).mouseleave(function(){d.fadeOut(c.speed)}).mousemove(b.throttle(c.throttle,r));b(window).resize(function(){e=f.offset()})}}var g,e,l=(new Date).getTime(),f=b(this),d=b("<canvas>",{id:"viewer"+l,style:"display:none; position:absolute; "+c.canvas_style}),n,h,p,o,j,m,s=parseInt(c.width,10),t=parseInt(c.height,
10);(function(){if(/IMG/.test(b(this)[0].nodeName)===true){f.wrapAll(b("<div>",{id:"ql_zoom_"+l,"class":"ql_zoom_container"}));f=b("#ql_zoom_"+l)}d.appendTo(f);d.css({width:c.width,height:c.height});d[0].setAttribute("width",s);d[0].setAttribute("height",t);/static/.test(void 0)&&f.css("position","relative");f.css({overflow:"hidden"});e=f.offset();g=d.get()[0].getContext("2d");h=f.find("img").first();h.imagesLoaded(function(){m=h.height();j=h.width()});n=b("<img>",{src:h.data("url")?h.data("url"):
h.attr("src"),style:"display:none;"}).appendTo(f);n.imagesLoaded(function(){o=this.height();p=this.width();i()})})()})};b.fn.ql_zoom.defaultOptions={width:"200px",height:"200px",speed:"800",throttle:50,pointer:"crosshair",canvas_style:"border:1px solid #444;"}})(jQuery);
