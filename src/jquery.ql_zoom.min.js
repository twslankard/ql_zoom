(function(b){b.fn.ql_zoom=function(w){var e=b.extend({},b.fn.ql_zoom.defaultOptions,w);return this.each(function(){var v,m,q=(new Date).getTime(),d=b(this),f=b("<canvas>",{id:"viewer"+q,style:e.canvas_style}),j,n,k,l,r,s,g=parseInt(e.width,10),h=parseInt(e.height,10),x=b("#output");(function(){if(/IMG/.test(b(this)[0].nodeName)===true){d.wrapAll(b("<div>",{id:"ql_zoom_"+q,"class":"ql_zoom_container"}));d=b("#ql_zoom_"+q)}n=d.find("img").first();s=n.height();r=n.width();j=b("<img>",{src:n.data("url"),
style:"display:none;"}).appendTo(d);j.imagesLoaded(function(){l=j.height();k=j.width()});f.appendTo(d);f.css({width:e.width,height:e.height});/static/.test(void 0)&&d.css("position","relative");d.css({overflow:"hidden",cursor:e.pointer});m=d.offset();v=f.get()[0].getContext("2d")})();d.mouseenter(function(){f.fadeIn(e.speed)}).mouseleave(function(){f.fadeOut(e.speed)}).mousemove(b.throttle(e.throttle,function(i){var c,a;a=g;c=h;i=[i.pageX-m.left-~~(a/2),i.pageY-m.top-~~(c/2)];f.css({left:i[0]+"px",
top:i[1]+"px"});c=f.position();var o,p,t,u;a=c.left*k/r+g/2;c=c.top*l/s+h/2;o=g;p=h;t=g*k/r;u=h*l/s;if(a<0)a=0;if(c<0)c=0;if(a>k-g){o=k-a;t=(g-(g-o))*1.5}if(c>l-h){p=l-c;u=(h-(h-p))*1.5}a=[~~a,~~c,~~o,~~p,0,0,~~t,~~u];x.html("sx = "+a[0]+", sy ="+a[1]+", sW = "+a[2]+", sH ="+a[3]+", dx = "+a[4]+", dy ="+a[5]+", dW = "+a[6]+", dH ="+a[7]+", pageX ="+i[0]+", pageY ="+i[1]);try{v.drawImage(j[0],a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7])}catch(y){console.dir(y)}}));b(window).resize(function(){m=d.offset()})})};
b.fn.ql_zoom.defaultOptions={width:"200px",height:"200px",speed:"800",throttle:50,pointer:"crosshair",canvas_style:"display:none; position:absolute; border:1px solid #444;"}})(jQuery);
